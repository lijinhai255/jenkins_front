(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{2366:function(t,e){for(var r=[],a=0;a<256;++a)r[a]=(a+256).toString(16).substr(1);function s(t,e){var a=e||0,s=r;return[s[t[a++]],s[t[a++]],s[t[a++]],s[t[a++]],"-",s[t[a++]],s[t[a++]],"-",s[t[a++]],s[t[a++]],"-",s[t[a++]],s[t[a++]],"-",s[t[a++]],s[t[a++]],s[t[a++]],s[t[a++]],s[t[a++]],s[t[a++]]].join("")}t.exports=s},2870:function(t,e,r){"use strict";var a=r("4fdb"),s=r.n(a);s.a},"4fdb":function(t,e,r){},"7ded":function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"d",(function(){return u})),r.d(e,"e",(function(){return d}));r("a4d3"),r("4de4"),r("e439"),r("dbb4"),r("b64b"),r("159b");var a=r("ade3"),s=r("b775");function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){Object(a["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var o=function(t){return s["a"].get("/public/getCaptcha",{params:{sid:t}})},l=function(t){return s["a"].post("/login/forget",i({},t))},c=function(t){return s["a"].post("/login/login",i({},t))},u=function(t){return s["a"].post("/login/reg",i({},t))},d=function(t){return s["a"].post("/login/reset",i({},t))}},a55b:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"layui-container fly-marginTop"},[r("div",{staticClass:"fly-panel fly-panel-user",attrs:{pad20:""}},[r("div",{staticClass:"layui-tab layui-tab-brief",attrs:{"lay-filter":"user"}},[r("ul",{staticClass:"layui-tab-title"},[r("li",{staticClass:"layui-this"},[t._v("登入")]),r("li",[r("router-link",{attrs:{to:{name:"reg"}}},[t._v("注册")])],1)]),r("div",{staticClass:"layui-form layui-tab-content",staticStyle:{padding:"20px 0"},attrs:{id:"LAY_ucm"}},[r("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var a=e.validate;return[r("div",{staticClass:"layui-tab-item layui-show"},[r("div",{staticClass:"layui-form layui-form-pane"},[r("form",{attrs:{method:"post"}},[r("div",{staticClass:"layui-form-item"},[r("label",{staticClass:"layui-form-label",attrs:{for:"L_email"}},[t._v("用户名")]),r("validation-provider",{attrs:{name:"email",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[r("div",{staticClass:"layui-input-inline"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"layui-input",attrs:{type:"text",name:"username",placeholder:"请输入用户名",autocomplete:"off"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),r("div",{staticClass:"layui-form-mid"},[r("span",{staticStyle:{color:"#c00"}},[t._v(t._s(a[0]))])])]}}],null,!0)})],1),r("div",{staticClass:"layui-form-item"},[r("label",{staticClass:"layui-form-label",attrs:{for:"L_pass"}},[t._v("密码")]),r("validation-provider",{attrs:{name:"password",rules:"required|min:6"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[r("div",{staticClass:"layui-input-inline"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"layui-input",attrs:{type:"password",name:"password",placeholder:"请输入密码",autocomplete:"off"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),r("div",{staticClass:"layui-form-mid"},[r("span",{staticStyle:{color:"#c00"}},[t._v(t._s(a[0]))])])]}}],null,!0)})],1),r("div",{staticClass:"layui-form-item"},[r("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[r("div",{staticClass:"layui-row"},[r("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),r("div",{staticClass:"layui-input-inline"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),r("div",{},[r("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(e){return t._getCode()}}})])]),r("div",{staticClass:"layui-form-mid"},[r("span",{staticStyle:{color:"#c00"}},[t._v(t._s(a[0]))])])]}}],null,!0)})],1),r("div",{staticClass:"layui-form-item"},[r("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(e){a().then(t.submit)}}},[t._v(" 立即登录 ")]),r("span",{staticStyle:{"padding-left":"20px"}},[r("router-link",{attrs:{to:{name:"forget"}}},[t._v("忘记密码？")])],1)]),r("div",{staticClass:"layui-form-item fly-form-app"},[r("span",[t._v("或者使用社交账号登入")]),r("a",{staticClass:"iconfont icon-qq",attrs:{href:"",onclick:"layer.msg('正在通过QQ登入', {icon:16, shade: 0.1, time:0})",title:"QQ登入"}}),r("a",{staticClass:"iconfont icon-weibo",attrs:{href:"",onclick:"layer.msg('正在通过微博登入', {icon:16, shade: 0.1, time:0})",title:"微博登入"}})])])])])]}}])})],1)])])])},s=[],n=(r("96cf"),r("1da1")),i=r("7bb1"),o=r("7ded"),l=r("c64e"),c=r.n(l),u={name:"login",components:{ValidationProvider:i["b"],ValidationObserver:i["a"]},data:function(){return{username:"",password:"",code:"",svg:""}},mounted:function(){var t="";localStorage.getItem("sid")?t=localStorage.getItem("sid"):(t=c()(),localStorage.setItem("sid",t)),this.$store.commit("setSid",t),this._getCode()},methods:{_getCode:function(){var t=this,e=this.$store.state.sid;Object(o["b"])(e).then((function(e){200===e.code&&(t.svg=e.data)}))},submit:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$refs.observer.validate();case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:Object(o["c"])({username:this.username,password:this.password,code:this.code,sid:this.$store.state.sid}).then((function(t){if(200===t.code){t.data.username=r.username,r.$store.commit("setUserInfo",t.data),r.$store.commit("setIsLogin",!0),r.$store.commit("setToken",t.token),localStorage.setItem("refreshToken",t.refreshToken),r.username="",r.password="",r.code="",requestAnimationFrame((function(){r.$refs.observer&&r.$refs.observer.reset()}));var e=r.$route.query.redirect||{name:"index"};r.$router.push(e)}else 200!==t.code&&r.$refs.codefield.setErrors([t.msg])})).catch((function(t){var e=t.response.data;500===e.code?r.$alert("用户名密码校验失败，请检查！"):r.$alert("服务器错误")}));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},d=u,f=(r("2870"),r("2877")),p=Object(f["a"])(d,a,s,!1,null,"6ac0778e",null);e["default"]=p.exports},c64e:function(t,e,r){var a=r("e1f4"),s=r("2366");function n(t,e,r){var n=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var i=t.random||(t.rng||a)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||s(i)}t.exports=n},e1f4:function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var a=new Uint8Array(16);t.exports=function(){return r(a),a}}else{var s=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),s[e]=t>>>((3&e)<<3)&255;return s}}}}]);
//# sourceMappingURL=login.f90063ef.js.map