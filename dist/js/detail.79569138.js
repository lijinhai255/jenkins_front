(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["detail"],{"2e43":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("dl",{staticClass:"fly-panel fly-list-one"},[i("dt",{staticClass:"fly-panel-title"},[t._v("本周热议")]),t._l(t.lists,(function(e,a){return i("dd",{key:"hotlist"+a},[i("router-link",{attrs:{to:{name:"detail",params:{tid:e._id}}}},[t._v(t._s(e.title))]),i("span",[i("i",{staticClass:"iconfont icon-pinglun1"}),t._v(" "+t._s(e.answer)+" ")])],1)}))],2)])},s=[],n=i("cc48"),c={name:"hotlist",data:function(){return{lists:[]}},mounted:function(){var t=this;Object(n["f"])().then((function(e){200===e.code&&(t.lists=e.data)}))}},o=c,r=i("2877"),l=Object(r["a"])(o,a,s,!1,null,"52f37b14",null);e["a"]=l.exports},"309e":function(t,e,i){"use strict";var a=i("77bc"),s=i.n(a);s.a},5539:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fly-panel"},[i("div",{staticClass:"fly-panel-title"},[t._v("在线课程")]),i("div",{staticClass:"fly-panel-main"},[i("a",{staticClass:"fly-zanzhu",staticStyle:{"background-color":"#5FB878"},attrs:{href:"https://class.imooc.com/sale/webfullstack?mc_marking=1eb5ce0be2ada8da4a6387b391f00b92&mc_channel=syzcjj1",target:"_blank"}},[t._v("大前端-更高层面进阶前端")]),i("a",{staticClass:"fly-zanzhu",staticStyle:{"background-color":"#5FB878"},attrs:{href:"https://www.imooc.com/learn/1091",target:"_blank"}},[t._v("3小时速成 Vue2.x 核心技术")])])])}],n={name:"ads"},c=n,o=i("2877"),r=Object(o["a"])(c,a,s,!1,null,"72d062e2",null);e["a"]=r.exports},"77bc":function(t,e,i){},"923a":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layui-container"},[i("imooc-panel"),i("div",{staticClass:"layui-row layui-col-space15"},[i("div",{staticClass:"layui-col-md8 content detail"},[i("div",{staticClass:"fly-panel detail-box"},[i("h1",[t._v(t._s(t.page.title))]),i("div",{staticClass:"fly-detail-info"},["share"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("分享")]):"ask"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("提问")]):"advise"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("建议")]):"logs"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("动态")]):"discuss"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("交流")]):"notice"===t.page.catalog?i("span",{staticClass:"layui-badge layui-bg-green fly-detail-column"},[t._v("公告")]):t._e(),"0"===t.page.isEnd?i("span",{staticClass:"layui-badge",staticStyle:{"background-color":"#999"}},[t._v("未结")]):i("span",{staticClass:"layui-badge",staticStyle:{"background-color":"#5FB878"}},[t._v("已结")]),i("span",{directives:[{name:"show",rawName:"v-show",value:"1"===t.page.isTop,expression:"page.isTop === '1'"}],staticClass:"layui-badge layui-bg-black"},[t._v("置顶")]),t._l(t.page.tags,(function(e,a){return i("span",{key:"tags"+a,staticClass:"layui-badge",class:e.class},[t._v(t._s(e.name))])})),i("div",{directives:[{name:"hasRole",rawName:"v-hasRole",value:"admin",expression:"'admin'"}]},[i("div",{staticClass:"fly-admin-box",attrs:{"data-id":"123"}},[i("span",{directives:[{name:"hasPermission",rawName:"v-hasPermission",value:["get","delete"],expression:"['get','delete']"}],staticClass:"layui-btn layui-btn-xs jie-admin",attrs:{type:"del"}},[t._v("删除")]),"0"===t.page.isTop?i("span",{staticClass:"layui-btn layui-btn-xs jie-admin",attrs:{type:"set",field:"stick",rank:"1"}},[t._v("置顶")]):i("span",{staticClass:"layui-btn layui-btn-xs jie-admin",staticStyle:{"background-color":"#ccc"},attrs:{type:"set",field:"stick",rank:"0"}},[t._v("取消置顶")])])]),i("span",{staticClass:"fly-list-nums"},[i("a",{attrs:{href:"#comment"}},[i("i",{staticClass:"iconfont",attrs:{title:"回答"}},[t._v("")]),t._v(" "+t._s(t.page.answer)+" ")]),i("i",{staticClass:"iconfont",attrs:{title:"人气"}},[t._v("")]),t._v(" "+t._s(t.page.reads)+" ")])],2),i("div",{staticClass:"detail-about"},[i("a",{staticClass:"fly-avatar",attrs:{href:"../user/home.html"}},[i("img",{attrs:{src:t.page.uid?t.page.uid.pic:"/img/bear-200-200.jpg"}})]),i("div",{staticClass:"fly-detail-user"},[i("a",{staticClass:"fly-link",attrs:{href:"../user/home.html"}},[i("cite",[t._v(t._s(t.page.uid?t.page.uid.name:"imooc"))]),t.page.uid&&"0"!==t.page.uid.isVip&&t.page.uid.isVip?i("i",{staticClass:"layui-badge fly-badge-vip mr1"},[t._v("VIP"+t._s(t.page.uid.isVip))]):t._e()]),i("span",[t._v(t._s(t._f("moment")(t.page.created)))])]),i("div",{staticClass:"detail-hits"},[i("span",{staticStyle:{"padding-right":"10px",color:"#FF7200"}},[t._v("悬赏："+t._s(t.page.fav))])])]),i("div",{staticClass:"layui-btn-container fly-detail-admin pt1"},[i("router-link",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.page.uid._id===t.user._id,expression:"page.isEnd === '0' && page.uid._id === user._id"}],staticClass:"layui-btn layui-btn-sm jie-admin",attrs:{to:{name:"edit",params:{tid:t.tid,page:t.page}}}},[t._v("编辑")]),i("a",{staticClass:"layui-btn layui-btn-sm jie-admin-collect",class:{"layui-btn-primary":t.page.isFav},on:{click:function(e){return e.preventDefault(),t.setCollect()}}},[t._v(t._s(t.page.isFav?"取消收藏":"收藏"))])],1),i("div",{staticClass:"detail-body photos",domProps:{innerHTML:t._s(t.content)}})]),i("div",{staticClass:"fly-panel detail-box",attrs:{id:"flyReply"}},[t._m(0),i("ul",{staticClass:"jieda",attrs:{id:"jieda"}},[t._l(t.comments,(function(e,a){return i("li",{key:"commments"+a,staticClass:"jieda-daan"},[i("div",{staticClass:"detail-about detail-about-reply"},[i("a",{staticClass:"fly-avatar",attrs:{href:""}},[i("img",{attrs:{src:e.cuid?e.cuid.pic:"/img/bear-200-200.jpg",alt:" "}})]),i("div",{staticClass:"fly-detail-user"},[i("router-link",{staticClass:"fly-link",attrs:{to:{name:"home",params:{uid:e.cuid?e.cuid._id:""}}}},[i("cite",[t._v(t._s(e.cuid?e.cuid.name:"imooc"))]),e.cuid&&"0"!==e.cuid.isVip&&e.cuid.isVip?i("i",{staticClass:"layui-badge fly-badge-vip"},[t._v("VIP"+t._s(e.cuid.isVip))]):t._e()]),0===a?i("span",[t._v("(楼主)")]):t._e()],1),i("div",{staticClass:"detail-hits"},[i("span",[t._v(t._s(t._f("moment")(e.created)))])]),i("i",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isBest,expression:"item.isBest === '1'"}],staticClass:"iconfont icon-caina",attrs:{title:"最佳答案"}})]),i("div",{directives:[{name:"richtext",rawName:"v-richtext",value:e.content,expression:"item.content"}],staticClass:"detail-body jieda-body photos"}),i("div",{staticClass:"jieda-reply"},[i("span",{staticClass:"jieda-zan",class:{zanok:"1"===e.handed},attrs:{type:"zan"},on:{click:function(i){return t.hands(e)}}},[i("i",{staticClass:"iconfont icon-zan"}),i("em",[t._v(t._s(e.hands))])]),i("span",{attrs:{type:"reply"},on:{click:function(i){return t.reply(e)}}},[i("i",{staticClass:"iconfont icon-svgmoban53"}),t._v(" 回复 ")]),i("div",{staticClass:"jieda-admin"},[i("span",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.user&&e.cuid._id===t.user._id,expression:"page.isEnd ==='0' && user && item.cuid._id === user._id"}],on:{click:function(i){return t.editComment(e)}}},[t._v("编辑")]),i("span",{directives:[{name:"show",rawName:"v-show",value:"0"===t.page.isEnd&&t.user&&t.page.uid&&t.page.uid._id===t.user._id,expression:"page.isEnd ==='0' && user && page.uid && page.uid._id === user._id"}],staticClass:"jieda-accept",on:{click:function(i){return t.setBest(e)}}},[t._v("采纳")])])])])})),0===t.comments.length?i("li",{staticClass:"fly-none"},[t._v("消灭零回复")]):t._e()],2),i("imooc-page",{directives:[{name:"show",rawName:"v-show",value:t.comments.length>0&&t.total>0,expression:"comments.length > 0 && total > 0"}],attrs:{showType:"icon",hasSelect:!1,hasTotal:!1,total:t.total,size:t.size,current:t.current,showEnd:!0},on:{changeCurrent:t.handleChange,changeLimit:t.handleLimit}}),i("div",{staticClass:"layui-form layui-form-pane"},[i("form",[i("validation-observer",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){var a=e.validate;return[i("imooc-edit",{attrs:{initContent:t.editInfo.content},on:{changeContent:t.addContent}}),i("div",{staticClass:"layui-form-item"},[i("validation-provider",{ref:"codefield",attrs:{name:"code",rules:"required|length:4"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[i("div",{staticClass:"layui-row"},[i("label",{staticClass:"layui-form-label",attrs:{for:"L_vercode"}},[t._v("验证码")]),i("div",{staticClass:"layui-input-inline"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.code,expression:"code"}],staticClass:"layui-input",attrs:{type:"text",name:"code",placeholder:"请输入验证码",autocomplete:"off"},domProps:{value:t.code},on:{input:function(e){e.target.composing||(t.code=e.target.value)}}})]),i("div",{},[i("span",{staticClass:"svg",staticStyle:{color:"#c00"},domProps:{innerHTML:t._s(t.svg)},on:{click:function(e){return t._getCode()}}})])]),i("div",{staticClass:"layui-form-mid"},[i("span",{staticStyle:{color:"#c00"}},[t._v(t._s(a[0]))])])]}}],null,!0)})],1),i("div",{staticClass:"layui-form-item"},[i("button",{staticClass:"layui-btn",attrs:{type:"button"},on:{click:function(e){a().then(t.submit)}}},[t._v("提交回复")])])]}}])})],1)])],1)]),i("div",{staticClass:"layui-col-md4"},[i("imooc-hotlist"),i("imooc-ads"),i("imooc-links")],1)])],1)},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{staticClass:"layui-elem-field layui-field-title",staticStyle:{"text-align":"center"}},[i("legend",[t._v("回帖")])])}],n=(i("a4d3"),i("99af"),i("4de4"),i("c975"),i("a434"),i("b0c0"),i("e439"),i("dbb4"),i("b64b"),i("ac1f"),i("5319"),i("498a"),i("159b"),i("ade3")),c=(i("96cf"),i("1da1")),o=i("cc48"),r=i("b775"),l=i("4328"),d=i.n(l),u=i("c0d6");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var m=function(t){var e=u["a"].state.token,i={};return""!==e&&(i={headers:{Authorization:"Bearer "+u["a"].state.token}}),r["a"].get("/public/comments?"+d.a.stringify(t),i)},v=function(t){return r["a"].post("/comments/reply",f({},t))},h=function(t){return r["a"].post("/comments/update",f({},t))},g=function(t){return r["a"].get("/comments/accept?"+d.a.stringify(t))},y=function(t){return r["a"].get("/comments/hands?"+d.a.stringify(t))},b=i("c24f"),_=i("2e43"),C=i("5539"),k=i("dec8"),j=i("9c97"),w=i("32d8"),O=i("81b3"),x=i("4ebd"),I=i("8b77"),E=i("cf45");function $(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function P(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?$(Object(i),!0).forEach((function(e){Object(n["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var B={name:"Detail",mixins:[O["a"]],props:["tid"],components:{"imooc-hotlist":_["a"],"imooc-ads":C["a"],"imooc-links":k["a"],"imooc-panel":j["a"],"imooc-edit":w["a"],"imooc-page":x["a"]},data:function(){return{total:0,size:10,current:0,page:{},comments:[],editInfo:{content:"",code:"",sid:""}}},mounted:function(){this.getPostDetail(),this.getCommentsList()},watch:{tid:function(t,e){this.getPostDetail(),this.getCommentsList()}},methods:{handleChange:function(t){this.current=t,this.getCommentsList()},handleLimit:function(t){this.size=t,this.getCommentsList()},getPostDetail:function(){var t=this;Object(o["b"])(this.tid).then((function(e){200===e.code&&(t.page=e.data)}))},getCommentsList:function(){var t=this;m({tid:this.tid,page:this.current,limit:this.size}).then((function(e){200===e.code&&(t.comments=e.data,t.total=e.total)}))},addContent:function(t){this.editInfo.content=t},submit:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,i,a,s,n,c=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$refs.observer.validate();case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:if(i=this.$store.state.isLogin,i){t.next=9;break}return this.$pop("shake","请先登录"),t.abrupt("return");case 9:if(a=this.$store.state.userInfo,"0"===a.status){t.next=13;break}return this.$pop("shake","用户已经禁言，请联系管理员"),t.abrupt("return");case 13:if(this.editInfo.code=this.code,this.editInfo.sid=this.$store.state.sid,this.editInfo.tid=this.tid,s={_id:a._id,pic:a.pic,name:a.name,isVip:a.isVip},"undefined"===typeof this.editInfo.cid||""===this.editInfo.cid){t.next=25;break}if(n=P({},this.editInfo),delete n["item"],this.editInfo.content!==this.editInfo.item.content){t.next=23;break}return this.$pop("shake","确定编辑了内容~~~"),t.abrupt("return");case 23:return h(n).then((function(t){if(200===t.code){var e=c.editInfo.item;e.content=c.editInfo.content,c.$pop("","更新评论成功"),c.code="",c.editInfo.content="",c.comments.splice(c.comments.indexOf(c.editInfo.item),1,e)}})),t.abrupt("return");case 25:v(this.editInfo).then((function(t){200===t.code?(c.$pop("","发表评论成功"),c.code="",c.editInfo.content="",t.data.cuid=s,c.comments.push(t.data),requestAnimationFrame((function(){c.$refs.observer&&c.$refs.observer.reset()})),c._getCode()):c.$alert(t.msg)}));case 26:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),editComment:function(t){this.editInfo.content=t.content,Object(E["b"])(".layui-input-block",500,-65),document.getElementById("edit").focus(),this.editInfo.cid=t._id,this.editInfo.item=t},setBest:function(t){var e=this;this.$confirm("确定采纳为最佳答案吗?",(function(){g({cid:t._id,tid:e.tid}).then((function(i){200===i.code&&(e.$pop("","设置最佳答案成功！"),t.isBest="1",e.page.isEnd="1")}))}),(function(){}))},hands:function(t){var e=this;y({cid:t._id}).then((function(i){200===i.code?(e.$pop("","点赞成功"),t.handed="1",t.hands+=1):e.$pop("shake",i.msg)}))},reply:function(t){var e=/^@[\S]+/g;this.editInfo.content?e.test(this.editInfo.content)?this.editInfo.content=this.editInfo.content.replace(e,"@"+t.cuid.name+" "):""!==this.editInfo.content&&(this.editInfo.content="@".concat(t.cuid.name," ").concat(this.editInfo.content)):this.editInfo.content="@"+t.cuid.name+" ",Object(E["b"])(".layui-input-block",500,-65),document.getElementById("edit").focus()},setCollect:function(){var t=this,e=this.$store.state.isLogin;if(e){var i={tid:this.tid,title:this.page.title,isFav:this.page.isFav?1:0};Object(b["a"])(i).then((function(e){200===e.code&&(t.page.isFav=!t.page.isFav,t.$pop("",t.page.isFav?"设置收藏成功":"取消收藏成功"))}))}else this.$pop("shake","请先登录后再进行收藏！")}},computed:{content:function(){return"undefined"===typeof this.page.content?"":""===this.page.content.trim()?"":Object(I["a"])(this.page.content)},user:function(){return this.$store.state.userInfo}}},S=B,F=(i("309e"),i("2877")),z=Object(F["a"])(S,a,s,!1,null,"7e225422",null);e["default"]=z.exports},dec8:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"fly-panel fly-link"},[i("h3",{staticClass:"fly-panel-title"},[t._v("友情链接")]),i("dl",{staticClass:"fly-panel-main"},[t._l(t.lists,(function(e,a){return i("dd",{key:"links"+a},[i("a",{attrs:{href:e.link,target:"_blank"}},[t._v(t._s(e.title))])])})),i("dd"),t._m(0),i("dd")],2)])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("dd",[i("a",{staticClass:"fly-link",attrs:{href:"mailto:brian@toimc.com?subject=%E7%94%B3%E8%AF%B7Fly%E7%A4%BE%E5%8C%BA%E5%8F%8B%E9%93%BE"}},[t._v("申请友链")])])}],n=i("cc48"),c={name:"links",data:function(){return{lists:[]}},mounted:function(){var t=this;Object(n["c"])().then((function(e){200===e.code&&(t.lists=e.data)}))}},o=c,r=i("2877"),l=Object(r["a"])(o,a,s,!1,null,"751758fa",null);e["a"]=l.exports}}]);
//# sourceMappingURL=detail.79569138.js.map